<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self'; script-src 'self';">
  <title>OneClaw</title>
  <link rel="stylesheet" href="settings.css">
</head>
<body>

  <div class="toast-container" id="toastContainer"></div>

  <div class="settings-layout">

    <!-- 左侧导航 -->
    <nav class="sidebar">
      <div class="sidebar-title" data-i18n="title">Settings</div>
      <ul class="nav-list">
        <li class="nav-item active" data-tab="provider">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <rect x="2.5" y="2.5" width="11" height="11" rx="2" stroke="currentColor" stroke-width="1.3"/>
            <rect x="6.5" y="6.5" width="3" height="3" stroke="currentColor" stroke-width="1.3"/>
            <path d="M8 1v1.5M8 13.5V16M1 8h1.5M13.5 8H16" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="nav.provider">Model</span>
        </li>
        <li class="nav-item" data-tab="channels">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M15 1L8 8" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M15 1L10 15L8 8L1 6L15 1Z" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span data-i18n="nav.feishu">Feishu Integration</span>
        </li>
        <li class="nav-item" data-tab="kimi">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M8 14.5c-3.5 0-6-2.5-6-5.5C2 5.5 5 2.5 8 2.5c1.5 0 2.5 1 2.5 1s-1 1-2 1C6 4.5 5 6 5 8.5c0 2 1.5 3 3 3s3-1 3-2.5v-.5c0-1.5 1.5-2.5 3-2.5s1.5 1 1.5 2c0 3.5-3.5 6.5-7.5 6.5z" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span data-i18n="nav.kimi">KimiClaw</span>
        </li>
        <li class="nav-item" data-tab="search">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="7" cy="7" r="4.5" stroke="currentColor" stroke-width="1.3"/>
            <path d="M10.5 10.5L14 14" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="nav.search">Search</span>
        </li>
        <li class="nav-item" data-tab="appearance">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="8" cy="8" r="2.5" stroke="currentColor" stroke-width="1.3"/>
          </svg>
          <span data-i18n="nav.appearance">外观显示</span>
        </li>
        <li class="nav-item" data-tab="advanced">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M3 14v-6M3 5V2M8 14v-4M8 7V2M13 14v-8M13 3V2" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
            <circle cx="3" cy="6.5" r="1.5" stroke="currentColor" stroke-width="1.3"/>
            <circle cx="8" cy="8.5" r="1.5" stroke="currentColor" stroke-width="1.3"/>
            <circle cx="13" cy="4.5" r="1.5" stroke="currentColor" stroke-width="1.3"/>
          </svg>
          <span data-i18n="nav.advanced">Advanced</span>
        </li>
        <li class="nav-item" data-tab="backup">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.3"/>
            <path d="M8 4v4l2.5 2.5" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span data-i18n="nav.backup">Backup & Restore</span>
        </li>
      </ul>
    </nav>

    <!-- 右侧内容区 -->
    <main class="content">

      <!-- Provider Tab -->
      <section class="tab-panel active" id="tabProvider">
        <h2 data-i18n="provider.title">Model Configuration</h2>
        <p class="desc" data-i18n="provider.desc">Change your LLM provider, API key, or model.</p>

        <!-- 当前 provider 状态指示 -->
        <div class="current-provider-status hidden" id="currentProviderStatus"></div>

        <!-- Provider 分段选择器 -->
        <div class="provider-tabs" id="providerTabs">
          <button class="provider-tab active" data-provider="anthropic">Anthropic</button>
          <button class="provider-tab" data-provider="moonshot">Kimi</button>
          <button class="provider-tab" data-provider="openai">OpenAI</button>
          <button class="provider-tab" data-provider="google">Google</button>
          <button class="provider-tab" data-provider="custom" data-i18n="provider.custom">Custom</button>
        </div>

        <!-- Moonshot 子平台 -->
        <div class="field-group hidden" id="subPlatformGroup">
          <label data-i18n="provider.platform">Platform</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="subPlatform" value="moonshot-cn" checked>
              <span>Moonshot CN</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="subPlatform" value="moonshot-ai">
              <span>Moonshot AI</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="subPlatform" value="kimi-code">
              <span>Kimi 会员订阅</span>
            </label>
          </div>
        </div>

        <!-- Custom: Base URL -->
        <div class="field-group hidden" id="baseURLGroup">
          <label for="baseURL" data-i18n="provider.baseUrl">Base URL</label>
          <input type="url" id="baseURL" placeholder="https://api.example.com/v1" autocomplete="off">
        </div>

        <!-- API Key -->
        <div class="field-group">
          <div class="label-row">
            <label for="apiKey" data-i18n="provider.apiKey">API Key</label>
            <a href="#" class="platform-link" id="platformLink">Get API Key →</a>
          </div>
          <div class="input-password-wrap">
            <input type="password" id="apiKey" placeholder="sk-ant-..." autocomplete="off" spellcheck="false">
            <button class="btn-toggle-vis" id="btnToggleKey" type="button" title="Toggle visibility">
              <svg class="icon-eye" width="18" height="18" viewBox="0 0 18 18" fill="none">
                <path d="M1.5 9C1.5 9 4 3.75 9 3.75C14 3.75 16.5 9 16.5 9C16.5 9 14 14.25 9 14.25C4 14.25 1.5 9 1.5 9Z" stroke="currentColor" stroke-width="1.3"/>
                <circle cx="9" cy="9" r="2.25" stroke="currentColor" stroke-width="1.3"/>
              </svg>
              <svg class="icon-eye-off hidden" width="18" height="18" viewBox="0 0 18 18" fill="none">
                <path d="M2.5 2.5L15.5 15.5M7.05 7.05A2.25 2.25 0 0010.95 10.95M1.5 9C1.5 9 4 3.75 9 3.75C10.2 3.75 11.3 4.1 12.25 4.6M16.5 9C16.5 9 14 14.25 9 14.25C7.8 14.25 6.7 13.9 5.75 13.4" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- 模型选择（非 Custom） -->
        <div class="field-group" id="modelSelectGroup">
          <label for="modelSelect" data-i18n="provider.model">Model</label>
          <select id="modelSelect"></select>
        </div>

        <!-- Custom: Model ID -->
        <div class="field-group hidden" id="modelInputGroup">
          <label for="modelInput" data-i18n="provider.modelId">Model ID</label>
          <input type="text" id="modelInput" placeholder="e.g. my-custom-model" autocomplete="off">
        </div>

        <!-- Custom: API Type -->
        <div class="field-group hidden" id="apiTypeGroup">
          <label data-i18n="provider.apiType">API Type</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="apiType" value="openai-completions" checked>
              <span>OpenAI Completions</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="apiType" value="anthropic-messages">
              <span>Anthropic Messages</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="apiType" value="openai-responses">
              <span>OpenAI Responses</span>
            </label>
          </div>
        </div>

        <!-- Custom: 图像支持 -->
        <div class="field-group hidden" id="imageSupportGroup">
          <label class="checkbox-item">
            <input type="checkbox" id="supportImage" checked>
            <span data-i18n="provider.supportImage">Supports image input</span>
          </label>
        </div>

        <!-- 错误 / 成功信息 -->
        <div class="msg-box hidden" id="msgBox"></div>

        <!-- 操作按钮 -->
        <div class="btn-row bottom-actions">
          <button class="btn-primary" id="btnSave">
            <span class="btn-text" data-i18n="provider.save">Save</span>
            <span class="btn-spinner hidden"></span>
          </button>
        </div>
      </section>

      <!-- Channels Tab -->
      <section class="tab-panel" id="tabChannels">
        <h2 data-i18n="feishu.title">Feishu Integration</h2>

        <div id="channelFeishu" class="channel-panel">
          <div class="channel-desc-row">
            <p class="desc" data-i18n="feishu.desc">Connect Feishu to chat with AI directly in your group.</p>
            <a href="#" class="platform-link" id="chConsoleLink" data-i18n="feishu.getKey">Open Feishu Console →</a>
          </div>

          <!-- 启用/禁用开关 -->
          <div class="toggle-row">
            <span class="toggle-label" data-i18n="feishu.enabled">Enable</span>
            <label class="toggle-switch">
              <input type="checkbox" id="chEnabled">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- 配置字段（禁用时隐藏） -->
          <div id="chFields" class="hidden">
            <!-- App ID -->
            <div class="field-group">
              <label for="chAppId" data-i18n="feishu.appId">Feishu App ID</label>
              <input type="text" id="chAppId" placeholder="cli_xxxxxxxx" autocomplete="off" spellcheck="false">
            </div>

            <!-- App Secret -->
            <div class="field-group">
              <label for="chAppSecret" data-i18n="feishu.appSecret">App Secret</label>
              <div class="input-password-wrap">
                <input type="password" id="chAppSecret" placeholder="••••••••" autocomplete="off" spellcheck="false">
                <button class="btn-toggle-vis" id="btnToggleChSecret" type="button" title="Toggle visibility">
                  <svg class="icon-eye" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M1.5 9C1.5 9 4 3.75 9 3.75C14 3.75 16.5 9 16.5 9C16.5 9 14 14.25 9 14.25C4 14.25 1.5 9 1.5 9Z" stroke="currentColor" stroke-width="1.3"/>
                    <circle cx="9" cy="9" r="2.25" stroke="currentColor" stroke-width="1.3"/>
                  </svg>
                  <svg class="icon-eye-off hidden" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M2.5 2.5L15.5 15.5M7.05 7.05A2.25 2.25 0 0010.95 10.95M1.5 9C1.5 9 4 3.75 9 3.75C10.2 3.75 11.3 4.1 12.25 4.6M16.5 9C16.5 9 14 14.25 9 14.25C7.8 14.25 6.7 13.9 5.75 13.4" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
            </div>

            <div class="field-group">
              <label for="chDmPolicy" data-i18n="feishu.dmPolicy">DM Access Mode</label>
              <select id="chDmPolicy">
                <option value="pairing" data-i18n="feishu.dmPolicyPairing">Access after pairing.</option>
                <option value="open" data-i18n="feishu.dmPolicyOpen">Everyone can access.</option>
              </select>
            </div>

            <div class="field-group">
              <label for="chDmScope" data-i18n="feishu.dmScope">DM Session Scope</label>
              <select id="chDmScope">
                <option value="main" data-i18n="feishu.dmScopeMain">All DMs share one session.</option>
                <option value="per-peer" data-i18n="feishu.dmScopePerPeer">Per user session.</option>
                <option value="per-channel-peer" data-i18n="feishu.dmScopePerChannelPeer">Per channel + user session.</option>
                <option value="per-account-channel-peer" data-i18n="feishu.dmScopePerAccountChannelPeer">Per account + channel + user session.</option>
              </select>
            </div>

            <div class="field-group">
              <label for="chGroupPolicy" data-i18n="feishu.groupPolicy">Group Access Mode</label>
              <select id="chGroupPolicy">
                <option value="allowlist" data-i18n="feishu.groupPolicyAllowlist">Only allowlisted groups can access.</option>
                <option value="open" data-i18n="feishu.groupPolicyOpen">All groups can access.</option>
                <option value="disabled" data-i18n="feishu.groupPolicyDisabled">Ignore all group messages.</option>
              </select>
            </div>

            <div id="chPairingSection">
              <div class="pairing-panel">
                <div class="pairing-header">
                  <span class="pairing-title" data-i18n="feishu.accessTitle">Pending & Authorized</span>
                  <div class="pairing-actions">
                    <button type="button" class="btn-icon" id="btnChAccessAddGroup" title="Add Group ID" aria-label="Add Group ID">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 5v14"></path>
                        <path d="M5 12h14"></path>
                      </svg>
                    </button>
                    <button type="button" class="btn-icon" id="btnChAccessRefresh" title="Refresh" aria-label="Refresh">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"></path>
                        <path d="M21 3v5h-5"></path>
                      </svg>
                    </button>
                  </div>
                </div>
                <div class="pairing-empty hidden" id="chAccessEmpty" data-i18n="feishu.noAccessEntries">
                  No pending or authorized entries.
                </div>
                <div class="pairing-list hidden" id="chAccessList"></div>
              </div>
            </div>
          </div>

          <!-- 错误 / 成功信息 -->
          <div class="msg-box hidden" id="chMsgBox"></div>

          <div class="dialog-backdrop hidden" id="chGroupDialog">
            <div class="dialog-card" role="dialog" aria-modal="true" aria-labelledby="chGroupDialogTitle">
              <div class="dialog-title" id="chGroupDialogTitle" data-i18n="feishu.addGroup">Add Group ID</div>
              <div class="dialog-guide">
                <ol class="dialog-guide-list">
                  <li class="dialog-guide-line" data-i18n="feishu.groupIdGuideStep1"></li>
                  <li class="dialog-guide-line" data-i18n="feishu.groupIdGuideStep2"></li>
                  <li class="dialog-guide-line" data-i18n="feishu.groupIdGuideStep3"></li>
                </ol>
              </div>
              <input type="text" id="chGroupDialogInput" placeholder="oc_xxx" autocomplete="off" spellcheck="false">
              <div class="dialog-actions">
                <button type="button" class="btn-secondary" id="btnChGroupDialogCancel" data-i18n="common.cancel">Cancel</button>
                <button type="button" class="btn-primary" id="btnChGroupDialogConfirm" data-i18n="common.confirm">Confirm</button>
              </div>
            </div>
          </div>

          <!-- 保存按钮 -->
          <div class="btn-row bottom-actions">
            <button class="btn-primary" id="btnChSave">
              <span class="btn-text" data-i18n="feishu.save">Save</span>
              <span class="btn-spinner hidden"></span>
            </button>
          </div>
        </div><!-- /channelFeishu -->
      </section>

      <!-- Kimi Tab -->
      <section class="tab-panel" id="tabKimi">
        <h2 data-i18n="kimi.title">KimiClaw</h2>

        <div class="channel-panel">
          <div class="channel-desc-row">
            <p class="desc" data-i18n="kimi.desc">Control OneClaw remotely via Kimi</p>
            <a href="#" class="platform-link" id="kimiBotPageLink" data-i18n="kimi.getGuide">Go to kimi.com/bot →</a>
          </div>

          <!-- 启用/禁用开关 -->
          <div class="toggle-row">
            <span class="toggle-label" data-i18n="kimi.enabled">Enable</span>
            <label class="toggle-switch">
              <input type="checkbox" id="kimiEnabled">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- 配置字段（禁用时隐藏） -->
          <div id="kimiFields" class="hidden">
            <p class="kimi-guide-text" data-i18n="kimi.guideText">Click 'Associate existing OpenClaw' → copy command → paste below</p>

            <div class="field-group">
              <label for="kimiSettingsInput" data-i18n="kimi.inputLabel">Paste BotToken or command (auto parse token)</label>
              <div class="input-password-wrap">
                <input type="password" id="kimiSettingsInput"
                  placeholder="bash &lt;(curl ...) --bot-token YOUR_TOKEN"
                  autocomplete="off" spellcheck="false">
                <button class="btn-toggle-vis" id="btnToggleKimiToken" type="button" title="Toggle visibility">
                  <svg class="icon-eye" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M1.5 9C1.5 9 4 3.75 9 3.75C14 3.75 16.5 9 16.5 9C16.5 9 14 14.25 9 14.25C4 14.25 1.5 9 1.5 9Z" stroke="currentColor" stroke-width="1.3"/>
                    <circle cx="9" cy="9" r="2.25" stroke="currentColor" stroke-width="1.3"/>
                  </svg>
                  <svg class="icon-eye-off hidden" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M2.5 2.5L15.5 15.5M7.05 7.05A2.25 2.25 0 0010.95 10.95M1.5 9C1.5 9 4 3.75 9 3.75C10.2 3.75 11.3 4.1 12.25 4.6M16.5 9C16.5 9 14 14.25 9 14.25C7.8 14.25 6.7 13.9 5.75 13.4" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- 错误 / 成功信息 -->
          <div class="msg-box hidden" id="kimiMsgBox"></div>

          <!-- 保存按钮 -->
          <div class="btn-row bottom-actions">
            <button class="btn-primary" id="btnKimiSave">
              <span class="btn-text" data-i18n="kimi.save">Save</span>
              <span class="btn-spinner hidden"></span>
            </button>
          </div>
        </div>
      </section>

      <!-- Search Tab -->
      <section class="tab-panel" id="tabSearch">
        <h2 data-i18n="search.title">Kimi Search</h2>

        <div class="channel-panel">
          <div class="channel-desc-row">
            <p class="desc" data-i18n="search.desc">Enable web search and fetch tools powered by Kimi.</p>
          </div>

          <!-- 启用/禁用开关 -->
          <div class="toggle-row">
            <span class="toggle-label" data-i18n="search.enabled">Enable</span>
            <label class="toggle-switch">
              <input type="checkbox" id="searchEnabled">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- 配置字段（禁用时隐藏） -->
          <div id="searchFields" class="hidden">
            <!-- 自动复用提示 -->
            <div class="msg-box info hidden" id="searchAutoKeyHint" data-i18n="search.autoKeyHint">
              Auto-reusing Kimi Code API Key.
            </div>

            <div class="field-group">
              <label for="searchApiKey" data-i18n="search.apiKeyLabel">API Key (optional if Kimi Code is configured)</label>
              <div class="input-password-wrap">
                <input type="password" id="searchApiKey" placeholder="sk-..." autocomplete="off" spellcheck="false">
                <button class="btn-toggle-vis" id="btnToggleSearchKey" type="button" title="Toggle visibility">
                  <svg class="icon-eye" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M1.5 9C1.5 9 4 3.75 9 3.75C14 3.75 16.5 9 16.5 9C16.5 9 14 14.25 9 14.25C4 14.25 1.5 9 1.5 9Z" stroke="currentColor" stroke-width="1.3"/>
                    <circle cx="9" cy="9" r="2.25" stroke="currentColor" stroke-width="1.3"/>
                  </svg>
                  <svg class="icon-eye-off hidden" width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path d="M2.5 2.5L15.5 15.5M7.05 7.05A2.25 2.25 0 0010.95 10.95M1.5 9C1.5 9 4 3.75 9 3.75C10.2 3.75 11.3 4.1 12.25 4.6M16.5 9C16.5 9 14 14.25 9 14.25C7.8 14.25 6.7 13.9 5.75 13.4" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- 错误 / 成功信息 -->
          <div class="msg-box hidden" id="searchMsgBox"></div>

          <!-- 保存按钮 -->
          <div class="btn-row bottom-actions">
            <button class="btn-primary" id="btnSearchSave">
              <span class="btn-text" data-i18n="search.save">Save</span>
              <span class="btn-spinner hidden"></span>
            </button>
          </div>
        </div>
      </section>

      <!-- Advanced Tab -->
      <section class="tab-panel" id="tabAdvanced">
        <h2 data-i18n="advanced.title">Advanced</h2>
        <p class="desc" data-i18n="advanced.desc">Browser tool and messaging channel settings.</p>

        <!-- Browser Profile -->
        <div class="field-group">
          <label data-i18n="advanced.browserProfile">Browser Profile</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="browserProfile" value="openclaw" checked>
              <span data-i18n="advanced.browserOpenclaw">Standalone browser instance</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="browserProfile" value="chrome">
              <span data-i18n="advanced.browserChrome">Chrome extension</span>
            </label>
          </div>
        </div>

        <!-- iMessage 频道 -->
        <div class="toggle-row">
          <span class="toggle-label" data-i18n="advanced.imessage">iMessage channel</span>
          <label class="toggle-switch">
            <input type="checkbox" id="imessageEnabled">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row hidden" id="launchAtLoginRow">
          <span class="toggle-label" data-i18n="advanced.launchAtLogin">Launch at login</span>
          <label class="toggle-switch">
            <input type="checkbox" id="launchAtLoginEnabled">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <span class="toggle-label"><span data-i18n="advanced.cliCommand">Terminal command</span> <code class="cli-command-code">openclaw</code></span>
          <label class="toggle-switch">
            <input type="checkbox" id="cliEnabled">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- 消息框 -->
        <div class="msg-box hidden" id="advMsgBox"></div>

        <!-- 保存按钮 -->
        <div class="btn-row bottom-actions">
          <button class="btn-primary" id="btnAdvSave">
            <span class="btn-text" data-i18n="advanced.save">Save</span>
            <span class="btn-spinner hidden"></span>
          </button>
        </div>
      </section>

      <!-- Appearance Tab -->
      <section class="tab-panel" id="tabAppearance">
        <h2 data-i18n="appearance.title">外观显示</h2>
        <p class="desc" data-i18n="appearance.desc">调整主题和聊天展示相关设置。</p>

        <div class="field-group">
          <label data-i18n="appearance.theme">主题</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="appearanceTheme" value="system" checked>
              <span data-i18n="appearance.theme.system">跟随系统</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="appearanceTheme" value="light">
              <span data-i18n="appearance.theme.light">浅色</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="appearanceTheme" value="dark">
              <span data-i18n="appearance.theme.dark">深色</span>
            </label>
          </div>
        </div>

        <div class="toggle-row">
          <span class="toggle-label" data-i18n="appearance.showThinking">显示思考过程</span>
          <label class="toggle-switch">
            <input type="checkbox" id="appearanceShowThinking">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="msg-box hidden" id="appearanceMsgBox"></div>

        <div class="btn-row bottom-actions">
          <button class="btn-primary" id="btnAppearanceSave">
            <span class="btn-text" data-i18n="appearance.save">保存</span>
            <span class="btn-spinner hidden"></span>
          </button>
        </div>
      </section>

      <!-- Backup Tab -->
      <section class="tab-panel" id="tabBackup">
        <h2 data-i18n="backup.title">Backup & Restore</h2>
        <p class="desc" data-i18n="backup.desc">Restore openclaw.json when config changes break startup.</p>

        <div class="backup-card">
          <div class="backup-card-header">
            <div class="backup-card-title" data-i18n="backup.historyTitle">Backup history</div>
            <button class="btn-primary btn-compact" id="btnRestoreLastKnownGood">
              <span class="btn-text" data-i18n="backup.restoreLastKnownGood">Restore Last Known Good</span>
              <span class="btn-spinner hidden"></span>
            </button>
          </div>
          <div class="backup-last-known-good" id="backupLastKnownGood"></div>
          <div class="backup-empty hidden" id="backupEmpty" data-i18n="backup.empty">
            No backup found yet. Save settings once to create one.
          </div>
          <div class="backup-list" id="backupList"></div>
        </div>

        <div class="backup-card">
          <div class="backup-card-title" data-i18n="backup.gatewayTitle">Gateway Control</div>
          <div class="backup-last-known-good" id="gatewayStateText"></div>
          <div class="btn-row gateway-actions">
            <button class="btn-primary btn-compact" id="btnGatewayRestart" data-i18n="backup.gatewayRestart">Restart Gateway</button>
            <button class="btn-primary btn-compact" id="btnGatewayStart" data-i18n="backup.gatewayStart">Start Gateway</button>
            <button class="btn-primary btn-compact" id="btnGatewayStop" data-i18n="backup.gatewayStop">Stop Gateway</button>
          </div>
        </div>

        <div class="backup-card">
          <div class="backup-card-title" data-i18n="backup.resetTitle">Reset Configuration</div>
          <div class="backup-meta" data-i18n="backup.resetDesc">
            Delete openclaw.json and relaunch app to run setup again. Chat history is kept.
          </div>
          <div class="btn-row">
            <button class="btn-primary btn-compact danger" id="btnResetConfig">
              <span class="btn-text" data-i18n="backup.resetButton">Reset Config And Relaunch</span>
              <span class="btn-spinner hidden"></span>
            </button>
          </div>
        </div>

        <div class="msg-box hidden" id="backupMsgBox"></div>
      </section>

    </main>
  </div>

  <script src="settings.js"></script>
</body>
</html>
